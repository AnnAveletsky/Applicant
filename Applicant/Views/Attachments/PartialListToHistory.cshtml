@model IEnumerable<Applicant.Models.Attachment>

<table class="table" style="margin:0px">
    @foreach (var item in Model)
    {
        <tr>
            <td>
                <a class="btn btn-info btn-sm" href="@Url.Action("Download", "Attachments", new { id = item.AttachmentId, applicantId = item.ApplicantId })">
                    <i class="glyphicon glyphicon-download"></i>
                </a>
            </td>
            <td>@Html.DisplayFor(modelItem => item.Name)</td>
            <td>
                
                
                @if (item.ApplicantId == null)
                {
                    <button class="btn btn-success btn-sm" onclick="addToApplicant(@item.AttachmentId)">
                        <i class="glyphicon glyphicon-paperclip"></i>
                    </button>
                }
                else if (item.HistoryId != null)
                {
                    <button type="submit" class="btn btn-danger btn-sm" onclick="deleteToApplicantToHistory(@item.AttachmentId)">
                        <i class="glyphicon glyphicon-paperclip"></i>
                    </button>
                }
                <button class="btn btn-danger btn-sm" type="submit" value="Удалить" data-toggle="modal" data-target="#myModal" onclick="del(@item.AttachmentId)">
                    <i class="glyphicon glyphicon-remove"></i>
                </button>
            </td>
        </tr>
    }
</table>

<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">

</div>
<script>
    function addToApplicant(attachmentId) {
        $.ajax({
            url: "@Url.Action("AddToApplicant", "Attachments")",
            data: "attachmentId=" + attachmentId,
            success: function (html) {
                $("#tableAttachments").empty();
                $("#tableAttachments").append(html);
            }
        });
    }
    function deleteToApplicantToHistory(attachmentId) {
        $.ajax({
            url: "@Url.Action("DeleteToApplicantToHistory", "Attachments")",
            data: "attachmentId=" + attachmentId,
        success: function (html) {
            $("#tableAttachments").empty();
            $("#tableAttachments").append(html);
        }
    });
    }
    function del(id) {
        $.ajax({
            url: "@Url.Action("Delete", "Attachments")",
            data: "id=" + id,
        success: function (html) {
            $("#myModal").empty();
            $("#myModal").append(html);
        }
    });
    }
</script>
@section Scripts {
    @Scripts.Render("~/scripts/jquery.unobtrusive-ajax.min.js")
}