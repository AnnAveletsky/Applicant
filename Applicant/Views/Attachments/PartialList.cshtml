@model IEnumerable<Applicant.Models.Attachment>

<table class="table">
    <tr>
        <th>@Html.DisplayNameFor(model => model.Name)</th>
        <th></th>
    </tr>

    @foreach (var item in Model)
    {
        <tr>
            <td>@Html.DisplayFor(modelItem => item.Name)</td>
            <td>
                <a class="btn btn-info btn-sm" href="@Url.Action("Download", "Attachments", new { id = item.AttachmentId, applicantId = item.ApplicantId })">
                    <i class="glyphicon glyphicon-download"></i>
                    Загрузить
                </a>
                @if (item.ApplicantId == null)
                {
                    <button class="btn btn-default" onclick="addToApplicant(@item.AttachmentId)">Добавить к соискателю</button>
                }
                else if (item.HistoryId != null)
                {
                    <button type="submit" class="btn btn-default" onclick="deleteToApplicantToHistory(@item.AttachmentId)">Удалить из соискателя</button>
                }
                <button class="btn btn-danger btn-sm" type="submit" value="Удалить" data-toggle="modal" data-target="#myModal" onclick="delAttach(@item.AttachmentId)">
                    <i class="glyphicon glyphicon-remove-circle"></i>
                    Удалить
                </button>

            </td>
        </tr>
    }
</table>

<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">

</div>
<script>
    function addToApplicant(attachmentId) {
        $.ajax({
            url: "@Url.Action("AddToApplicant", "Attachments")",
            data: "attachmentId=" + attachmentId,
            success: function (html) {
                $("#tableAttachments").empty();
                $("#tableAttachments").append(html);
            }
        });
    }
    function deleteToApplicantToHistory(attachmentId) {
        $.ajax({
            url: "@Url.Action("DeleteToApplicant", "Attachments")",
            data: "attachmentId=" + attachmentId,
        success: function (html) {
            $("#tableAttachments").empty();
            $("#tableAttachments").append(html);
        }
    });
    }
    function delAttach(id) {
        $.ajax({
            url: "@Url.Action("Delete", "Attachments")",
            data: "id=" + id,
        success: function (html) {
            $("#myModal").empty();
            $("#myModal").append(html);
        }
    });
    }
</script>
@section Scripts {
    @Scripts.Render("~/scripts/jquery.unobtrusive-ajax.min.js")
}